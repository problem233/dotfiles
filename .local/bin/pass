#!/bin/bash
login=$(zenity --entry --width=500 --title=pass --text=Login: --entry-text=$(whoami))
[ -z "$login" ] && exit
password=$(zenity --password --title=pass --text=Password:)
[ -z "$password" ] && exit
site=$(zenity --entry --width=500 --title=pass --text=Site:)
[ -z "$site" ] && exit
args=$(zenity --entry --width=500 --title=pass --text="Extra arguments:" --entry-text=-C1)
res=$(lesspass "$site" "$login" "$password" $args)
unset password
if [ "$1" == --show ]; then
  zenity --info --width=500 --timeout=15 --no-markup --text="Your password: $res"
else
  printf '%s' "$res"  | xclip -selection clipboard
  zenity --info --width=500 --timeout=1 --text="Copied! Clipboard will be cleared in 10 seconds..."
  for i in {10..1..-1}; do sleep 1s; done
  printf '' | xclip -selection clipboard
  zenity --info --width=500 --timeout=1 --text="Clipboard has been cleared."
fi
